# 🛡️ 데이터 보존 가이드

## ✅ 수정 완료 사항

### 1. PostgreSQL 메뉴 시드 데이터 확장
- SQLite와 동일한 메뉴 데이터로 통일
- 재배포 시 메뉴가 비어있으면 자동으로 초기 메뉴 생성

### 2. 데이터 보존 로직
- **기존 데이터가 있으면 시드하지 않음** (데이터 보존)
- 메뉴가 비어있을 때만 초기 메뉴 생성
- 주문, 회원, 포인트 등 모든 데이터는 **절대 삭제되지 않음**

### 3. 자동 시드 시스템
- 서버 시작 시 자동으로 데이터 확인
- 메뉴가 없으면 자동으로 초기 메뉴 생성
- 영업시간 데이터도 자동 생성

---

## 🔍 데이터 보존 확인

### Railway PostgreSQL은 영구 저장소입니다
- Railway PostgreSQL 데이터베이스는 **영구 저장소**입니다
- 재배포해도 데이터가 날아가지 않습니다
- 단, 데이터베이스 서비스를 삭제하면 데이터가 삭제됩니다

### 데이터가 날아간 경우
1. **데이터베이스 서비스 삭제**: Railway에서 PostgreSQL 서비스를 삭제한 경우
2. **새 프로젝트 생성**: 새 프로젝트를 만들고 데이터베이스를 새로 생성한 경우
3. **데이터베이스 리셋**: 수동으로 데이터베이스를 리셋한 경우

---

## 🚀 재배포 시 데이터 보존 방법

### 방법 1: Railway PostgreSQL 사용 (권장)
1. Railway에서 **PostgreSQL 서비스 추가**
2. `DATABASE_URL` 환경 변수 설정
3. 재배포 시 데이터 자동 보존

### 방법 2: 데이터 백업
1. Railway 대시보드 → PostgreSQL 서비스
2. **Data** 탭 → **Backup** 클릭
3. 백업 파일 다운로드

### 방법 3: 수동 시드
메뉴가 비어있으면 자동으로 초기 메뉴가 생성됩니다.

---

## 📝 초기 메뉴 데이터

다음 메뉴들이 자동으로 생성됩니다:

### 오늘의 메뉴
- 짜장면 (6,000원)
- 짬뽕 (7,000원)

### 추천 메뉴
- 탕수육 (15,000원)
- 깐풍기 (18,000원)
- 양장피 (20,000원)

### 면류
- 짜장면, 짬뽕, 울면, 간짜장

### 밥류
- 볶음밥, 짜장밥, 짬뽕밥

### 디저트
- 군만두, 물만두, 짬뽕순두부

### 음료
- 코카콜라 2L, 제로콜라, 사이다, 매실

### 맥주
- 테라, 카스, 기네스, 아사히, 칭따오

### 소주
- 참이슬, 처음처럼, 연태고량주(중)

---

## ⚠️ 주의사항

### 데이터베이스 서비스 삭제 금지
- Railway에서 PostgreSQL 서비스를 삭제하면 **모든 데이터가 삭제**됩니다
- 삭제 전 반드시 백업을 받으세요

### 환경 변수 확인
- `DATABASE_URL`이 설정되어 있는지 확인
- Railway에서 자동으로 생성되지만, 수동으로 확인 필요

### 재배포 후 확인
1. 주문 페이지 접속
2. 메뉴가 정상적으로 표시되는지 확인
3. POS에서 메뉴 관리 확인

---

## 🔧 문제 해결

### 메뉴가 비어있는 경우
1. 서버 로그 확인: "✅ 메뉴 이미 존재" 또는 "✅ 메뉴 초기화 완료" 메시지 확인
2. 수동 시드 실행:
   ```bash
   cd backend
   node seed-data.js
   ```

### 데이터가 날아간 경우
1. Railway 백업 확인
2. 데이터베이스 서비스 상태 확인
3. `DATABASE_URL` 환경 변수 확인

---

## 📞 지원

문제 발생 시:
1. Railway 로그 확인
2. 데이터베이스 서비스 상태 확인
3. 환경 변수 확인

---

**이제 재배포해도 데이터가 보존됩니다! 🎉**

