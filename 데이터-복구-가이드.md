# 🔄 데이터 복구 가이드

## 어제 가입한 회원 데이터가 없는 경우

### 가능한 원인

1. **데이터베이스 서비스 삭제/재생성**
   - Railway에서 PostgreSQL 서비스를 삭제하고 새로 만든 경우
   - 새 프로젝트를 만들고 데이터베이스를 새로 생성한 경우

2. **데이터베이스 리셋**
   - Railway에서 데이터베이스를 수동으로 리셋한 경우

3. **환경 변수 변경**
   - `DATABASE_URL`이 다른 데이터베이스를 가리키는 경우

---

## 🔍 데이터 확인 방법

### 1. Railway에서 확인

1. Railway 대시보드 접속
2. 프로젝트 선택
3. **PostgreSQL 서비스** 클릭
4. **Data** 탭 → **Query** 클릭
5. 다음 쿼리 실행:

```sql
-- 회원 수 확인
SELECT COUNT(*) as total_users FROM users;

-- 최근 가입 회원 확인
SELECT "userId", name, phone, "createdAt" 
FROM users 
ORDER BY "createdAt" DESC 
LIMIT 10;

-- 주문 수 확인
SELECT COUNT(*) as total_orders FROM orders;

-- 최근 주문 확인
SELECT "orderId", "customerName", phone, status, "createdAt"
FROM orders
ORDER BY "createdAt" DESC
LIMIT 10;
```

### 2. 서버 로그 확인

Railway → **Deployments** → **View Logs**에서:
- "✅ PostgreSQL 데이터베이스 사용 (Railway)" 메시지 확인
- 데이터베이스 연결 오류 확인

---

## 💾 데이터 복구 방법

### 방법 1: Railway 백업 확인

1. Railway → PostgreSQL 서비스
2. **Data** 탭 → **Backups** 확인
3. 백업이 있으면 복원

### 방법 2: 데이터베이스 확인

1. Railway → PostgreSQL 서비스
2. **Data** 탭 → **Query** 클릭
3. 위의 쿼리로 데이터 확인

### 방법 3: 환경 변수 확인

Railway → **Variables** 탭에서:
- `DATABASE_URL`이 올바른 데이터베이스를 가리키는지 확인
- 여러 PostgreSQL 서비스가 있으면 올바른 것을 사용하는지 확인

---

## 🚨 데이터가 정말 없는 경우

### 새로 시작해야 하는 경우

1. **회원 데이터**: 복구 불가 (백업이 없으면)
2. **주문 데이터**: 복구 불가 (백업이 없으면)
3. **메뉴 데이터**: 자동으로 생성됨 (25개 메뉴)

### 앞으로 데이터 보존 방법

1. **정기 백업**
   - Railway → PostgreSQL → **Data** → **Backup** 클릭
   - 주기적으로 백업 다운로드

2. **데이터베이스 서비스 삭제 금지**
   - Railway에서 PostgreSQL 서비스를 삭제하지 마세요
   - 삭제하면 모든 데이터가 사라집니다

3. **환경 변수 확인**
   - `DATABASE_URL`이 변경되지 않았는지 확인

---

## 🔧 현재 상태 확인

### 서버에서 확인

Railway 로그에서 다음 메시지 확인:
- "✅ PostgreSQL 데이터베이스 사용 (Railway)"
- "✅ 메뉴 이미 존재" 또는 "✅ 메뉴 초기화 완료"

### 데이터베이스 직접 확인

Railway → PostgreSQL → **Data** → **Query**에서:
```sql
-- 전체 테이블 확인
SELECT table_name 
FROM information_schema.tables 
WHERE table_schema = 'public';
```

---

## 📝 다음 단계

### 1. 데이터 확인
- Railway에서 위의 쿼리로 데이터 확인
- 회원 데이터가 있는지 확인

### 2. 데이터가 없는 경우
- 새로 시작 (회원 재가입 필요)
- 메뉴는 자동으로 생성됨

### 3. 데이터가 있는 경우
- 환경 변수 확인
- 데이터베이스 연결 확인

---

## ⚠️ 주의사항

### 데이터베이스 서비스 삭제 금지
- Railway에서 PostgreSQL 서비스를 삭제하면 **모든 데이터가 삭제**됩니다
- 삭제 전 반드시 백업을 받으세요

### 환경 변수 변경 주의
- `DATABASE_URL`을 변경하면 다른 데이터베이스를 사용하게 됩니다
- 변경 전 기존 데이터베이스 URL을 백업하세요

---

## 🆘 문제 해결

### 데이터가 보이지 않는 경우

1. **다른 데이터베이스 사용 중일 수 있음**
   - Railway에서 여러 PostgreSQL 서비스가 있는지 확인
   - `DATABASE_URL`이 올바른 서비스를 가리키는지 확인

2. **데이터베이스 연결 문제**
   - Railway 로그에서 연결 오류 확인
   - 서비스 재시작

3. **테이블이 없는 경우**
   - 서버 재시작 시 자동으로 테이블 생성됨
   - 메뉴 데이터는 자동으로 시드됨

---

**데이터 확인 후 알려주시면 추가 도움을 드리겠습니다! 🔍**

