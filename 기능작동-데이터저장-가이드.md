# 🚀 기능 작동 및 데이터 저장 가이드

## ✅ 필수 단계

### 1. 의존성 설치
```bash
cd backend
npm install
```

### 2. 서버 실행

#### 방법 1: 배치 파일 사용 (가장 간단)
```bash
start.bat
```
또는
```bash
서버실행.bat
```

#### 방법 2: 수동 실행
```bash
cd backend
npm start
```

### 3. 데이터베이스 설정

#### 로컬 개발 (SQLite - 자동)
- `DATABASE_URL` 환경 변수가 없으면 자동으로 SQLite 사용
- 데이터는 `backend/restaurant.db` 파일에 저장
- **데이터는 영구 저장됨** (서버 재시작해도 유지)

#### 프로덕션 (PostgreSQL - Railway)
- Railway에서 PostgreSQL 서비스 생성
- `DATABASE_URL` 환경 변수 설정
- 데이터는 Railway PostgreSQL에 영구 저장

### 4. 서버 접속 확인

#### 로컬 접속
- 주문 페이지: http://localhost:3000/order-new
- POS 페이지: http://localhost:3000/pos/login.html

#### 외부 접속 (cloudflared 사용)
- `start.bat`에서 [2] External Access 선택
- 생성된 URL 사용 (예: https://xxx-yyy.trycloudflare.com)

---

## 📊 데이터 저장 확인

### 데이터가 저장되는 항목
- ✅ 회원 정보 (가입, 로그인)
- ✅ 주문 내역
- ✅ 포인트 적립/사용
- ✅ 쿠폰 발급/사용
- ✅ 즐겨찾기 메뉴
- ✅ 주소록
- ✅ 리뷰

### 데이터 확인 방법

#### SQLite (로컬)
```bash
sqlite3 backend/restaurant.db
.tables
SELECT * FROM users;
SELECT * FROM orders;
```

#### PostgreSQL (Railway)
- Railway 대시보드 → PostgreSQL 서비스 → Data 탭
- 또는 pgAdmin 사용

---

## 🔧 문제 해결

### 서버가 시작되지 않을 때
1. Node.js 설치 확인: `node --version` (18.x 이상 필요)
2. 포트 3000이 사용 중인지 확인
3. 의존성 재설치: `cd backend && npm install`

### 데이터가 저장되지 않을 때
1. 데이터베이스 파일 권한 확인
2. 로그 확인: 서버 콘솔에서 에러 메시지 확인
3. 데이터베이스 초기화 확인: 서버 시작 시 "데이터베이스 초기화 중..." 메시지 확인

### 기능이 작동하지 않을 때
1. 브라우저 콘솔 확인 (F12)
2. 서버 로그 확인
3. 네트워크 탭에서 API 요청 확인

---

## 🎯 빠른 시작 체크리스트

- [ ] Node.js 18.x 이상 설치됨
- [ ] `cd backend && npm install` 실행 완료
- [ ] `npm start` 또는 `start.bat` 실행
- [ ] http://localhost:3000/order-new 접속 확인
- [ ] 회원가입 테스트
- [ ] 주문 생성 테스트
- [ ] 데이터 저장 확인

---

## 💡 추가 정보

### 환경 변수 (선택사항)
```bash
# 개발 모드
NODE_ENV=development

# PostgreSQL 사용 (Railway)
DATABASE_URL=postgresql://user:password@host:port/database
```

### 데이터 백업
- SQLite: `backend/restaurant.db` 파일 복사
- PostgreSQL: Railway 대시보드에서 백업 다운로드

---

## 📞 지원

문제가 발생하면:
1. 서버 로그 확인
2. 브라우저 콘솔 확인
3. 데이터베이스 연결 상태 확인

