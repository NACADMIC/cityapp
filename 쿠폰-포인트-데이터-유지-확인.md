# β… μΏ ν°/ν¬μΈνΈ λ°μ΄ν„° μ μ§€ ν™•μΈ

## π― μμ • μ™„λ£ μ‚¬ν•­

### 1. μ‹ κ· κ°€μ… μΏ ν° μλ™ λ°κΈ‰ κ°μ„  β…
- β… PostgreSQL: μΏ ν° μƒμ„± λ° λ°κΈ‰ μ¦‰μ‹ μ²λ¦¬
- β… SQLite: μΏ ν° μƒμ„± λ° λ°κΈ‰ μ¦‰μ‹ μ²λ¦¬
- β… μ—λ¬ μ²λ¦¬ κ°•ν™” (λ°κΈ‰ μ‹¤ν¨ν•΄λ„ νμ›κ°€μ… μ„±κ³µ)
- β… μΏ ν° λ°κΈ‰ ν™•μΈ λ΅μ§ κ°μ„ 

### 2. μΏ ν°/ν¬μΈνΈ λ°μ΄ν„° μ μ§€ λ³΄μ¥ β…
- β… μΏ ν° λ°κΈ‰ κΈ°λ΅: `coupon_usage` ν…μ΄λΈ”μ— μ €μ¥ (μκµ¬ λ³΄μ΅΄)
- β… ν¬μΈνΈ μ λ¦½/μ‚¬μ©: `users.points` μ»¬λΌμ— μ €μ¥ (μκµ¬ λ³΄μ΅΄)
- β… ν¬μΈνΈ λ‚΄μ—­: `point_history` ν…μ΄λΈ”μ— μ €μ¥ (μκµ¬ λ³΄μ΅΄)
- β… μΏ ν° μ‚¬μ© λ‚΄μ—­: `coupon_usage` ν…μ΄λΈ”μ— μ €μ¥ (μκµ¬ λ³΄μ΅΄)

---

## π“ λ°μ΄ν„° μ €μ¥ κµ¬μ΅°

### μΏ ν° λ°μ΄ν„°
```
coupons ν…μ΄λΈ”
  - μΏ ν° μ •λ³΄ (μ½”λ“, μ΄λ¦„, ν• μΈμ•΅ λ“±)
  - μκµ¬ μ €μ¥ β…

coupon_usage ν…μ΄λΈ”
  - μΏ ν° λ°κΈ‰ κΈ°λ΅ (userId, couponId)
  - μΏ ν° μ‚¬μ© κΈ°λ΅ (orderId, usedAt)
  - μκµ¬ μ €μ¥ β…
```

### ν¬μΈνΈ λ°μ΄ν„°
```
users ν…μ΄λΈ”
  - points μ»¬λΌ (λ³΄μ  ν¬μΈνΈ)
  - μκµ¬ μ €μ¥ β…

point_history ν…μ΄λΈ”
  - ν¬μΈνΈ μ λ¦½/μ‚¬μ© λ‚΄μ—­
  - μκµ¬ μ €μ¥ β…
```

---

## π” λ°μ΄ν„° μ μ§€ ν™•μΈ

### 1. μΏ ν° λ°κΈ‰ ν™•μΈ
```sql
-- μ‚¬μ©μ μΏ ν° ν™•μΈ
SELECT c.*, cu.*
FROM coupons c
INNER JOIN coupon_usage cu ON c.id = cu."couponId"
WHERE cu."userId" = [userId]
ORDER BY cu.id DESC;
```

### 2. ν¬μΈνΈ ν™•μΈ
```sql
-- μ‚¬μ©μ ν¬μΈνΈ ν™•μΈ
SELECT "userId", name, phone, points
FROM users
WHERE "userId" = [userId];

-- ν¬μΈνΈ λ‚΄μ—­ ν™•μΈ
SELECT *
FROM point_history
WHERE "userId" = [userId]
ORDER BY "createdAt" DESC;
```

---

## β… μ¬λ°°ν¬ μ‹ λ°μ΄ν„° μ μ§€

### μΏ ν° λ°μ΄ν„°
- β… `coupons` ν…μ΄λΈ”: μκµ¬ μ €μ¥ (μ¬λ°°ν¬ν•΄λ„ μ μ§€)
- β… `coupon_usage` ν…μ΄λΈ”: μκµ¬ μ €μ¥ (μ¬λ°°ν¬ν•΄λ„ μ μ§€)
- β… μΏ ν° λ°κΈ‰ κΈ°λ΅: μκµ¬ μ €μ¥ (μ¬λ°°ν¬ν•΄λ„ μ μ§€)
- β… μΏ ν° μ‚¬μ© κΈ°λ΅: μκµ¬ μ €μ¥ (μ¬λ°°ν¬ν•΄λ„ μ μ§€)

### ν¬μΈνΈ λ°μ΄ν„°
- β… `users.points`: μκµ¬ μ €μ¥ (μ¬λ°°ν¬ν•΄λ„ μ μ§€)
- β… `point_history`: μκµ¬ μ €μ¥ (μ¬λ°°ν¬ν•΄λ„ μ μ§€)
- β… ν¬μΈνΈ μ λ¦½ λ‚΄μ—­: μκµ¬ μ €μ¥ (μ¬λ°°ν¬ν•΄λ„ μ μ§€)
- β… ν¬μΈνΈ μ‚¬μ© λ‚΄μ—­: μκµ¬ μ €μ¥ (μ¬λ°°ν¬ν•΄λ„ μ μ§€)

---

## π€ μ‹ κ· κ°€μ… μΏ ν° λ°κΈ‰ ν”„λ΅μ„Έμ¤

### 1. νμ›κ°€μ…
```
μ‚¬μ©μ μ •λ³΄ μ…λ ¥
  β†“
νμ› μƒμ„± (users ν…μ΄λΈ”)
  β†“
μΏ ν° μƒμ„± (coupons ν…μ΄λΈ”) - μ¦‰μ‹ μ²λ¦¬
  β†“
μΏ ν° λ°κΈ‰ (coupon_usage ν…μ΄λΈ”) - μ¦‰μ‹ μ²λ¦¬
  β†“
μ™„λ£ β…
```

### 2. μΏ ν° μ‚¬μ©
```
μΏ ν° μ½”λ“ μ…λ ¥
  β†“
μΏ ν° κ²€μ¦ (μ†μ  μ—¬λ¶€, μ‚¬μ© μ—¬λ¶€)
  β†“
μ£Όλ¬Έ μƒμ„±
  β†“
μΏ ν° μ‚¬μ© κΈ°λ΅ (coupon_usage ν…μ΄λΈ” μ—…λ°μ΄νΈ)
  β†“
μ™„λ£ β…
```

### 3. ν¬μΈνΈ μ λ¦½/μ‚¬μ©
```
μ£Όλ¬Έ μ™„λ£
  β†“
ν¬μΈνΈ μ λ¦½ (users.points μ—…λ°μ΄νΈ)
  β†“
ν¬μΈνΈ λ‚΄μ—­ μ €μ¥ (point_history ν…μ΄λΈ”)
  β†“
μ™„λ£ β…
```

---

## β οΈ μ£Όμμ‚¬ν•­

### λ°μ΄ν„°λ² μ΄μ¤ μ„λΉ„μ¤ μ‚­μ  κΈμ§€
- Railwayμ—μ„ PostgreSQL μ„λΉ„μ¤λ¥Ό μ‚­μ ν•λ©΄ **λ¨λ“  λ°μ΄ν„°κ°€ μ‚­μ **λ©λ‹λ‹¤
- μΏ ν°, ν¬μΈνΈ, μ£Όλ¬Έ λ“± λ¨λ“  λ°μ΄ν„°κ°€ μ‚¬λΌμ§‘λ‹λ‹¤

### μ •κΈ° λ°±μ—… (κ¶μ¥)
- Railway β†’ PostgreSQL β†’ **Data** β†’ **Backup**
- μ£ΌκΈ°μ μΌλ΅ λ°±μ—… λ‹¤μ΄λ΅λ“ (μΌμ£ΌμΌλ§λ‹¤ κ¶μ¥)

---

## β… μµμΆ… ν™•μΈ

### μΏ ν° λ°μ΄ν„° μ μ§€
- [x] μΏ ν° λ°κΈ‰ κΈ°λ΅ μκµ¬ μ €μ¥
- [x] μΏ ν° μ‚¬μ© κΈ°λ΅ μκµ¬ μ €μ¥
- [x] μ¬λ°°ν¬ν•΄λ„ μΏ ν° λ°μ΄ν„° μ μ§€

### ν¬μΈνΈ λ°μ΄ν„° μ μ§€
- [x] ν¬μΈνΈ λ³΄μ λ‰ μκµ¬ μ €μ¥
- [x] ν¬μΈνΈ λ‚΄μ—­ μκµ¬ μ €μ¥
- [x] μ¬λ°°ν¬ν•΄λ„ ν¬μΈνΈ λ°μ΄ν„° μ μ§€

### μ‹ κ· κ°€μ… μΏ ν° λ°κΈ‰
- [x] μ¦‰μ‹ μΏ ν° μƒμ„± λ° λ°κΈ‰
- [x] μ—λ¬ μ²λ¦¬ κ°•ν™”
- [x] λ°κΈ‰ ν™•μΈ λ΅μ§ κ°μ„ 

---

**μΏ ν°κ³Ό ν¬μΈνΈ λ°μ΄ν„°λ” μκµ¬ μ €μ¥λλ©°, μ¬λ°°ν¬ν•΄λ„ μ μ§€λ©λ‹λ‹¤! π‰**

